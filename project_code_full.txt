

==================================================
FILE: ./package.json
==================================================
{
  "name": "ai-menu-translator",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "concurrently \"npm run server\" \"npm run vite\"",
    "server": "cd server && npm start",
    "vite": "vite",
    "build": "vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^19.1.1",
    "react-dom": "^19.1.1"
  },
  "devDependencies": {
    "@eslint/js": "^9.36.0",
    "@types/react": "^19.1.16",
    "@types/react-dom": "^19.1.9",
    "@vitejs/plugin-react": "^5.0.4",
    "concurrently": "^9.2.1",
    "eslint": "^9.36.0",
    "eslint-plugin-react-hooks": "^5.2.0",
    "eslint-plugin-react-refresh": "^0.4.22",
    "globals": "^16.4.0",
    "kill-port": "^2.0.1",
    "vite": "^7.1.7"
  }
}


==================================================
FILE: ./README.md
==================================================
# React + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) (or [oxc](https://oxc.rs) when used in [rolldown-vite](https://vite.dev/guide/rolldown)) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

## React Compiler

The React Compiler is not enabled on this template because of its impact on dev & build performances. To add it, see [this documentation](https://react.dev/learn/react-compiler/installation).

## Expanding the ESLint configuration

If you are developing a production application, we recommend using TypeScript with type-aware lint rules enabled. Check out the [TS template](https://github.com/vitejs/vite/tree/main/packages/create-vite/template-react-ts) for information on how to integrate TypeScript and [`typescript-eslint`](https://typescript-eslint.io) in your project.


==================================================
FILE: ./vite.config.js
==================================================
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vite.dev/config/
export default defineConfig({
  plugins: [react()],
})


==================================================
FILE: ./index.html
==================================================
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/img/kami logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KAMI-translator</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>


==================================================
FILE: ./eslint.config.js
==================================================
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import { defineConfig, globalIgnores } from 'eslint/config'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{js,jsx}'],
    extends: [
      js.configs.recommended,
      reactHooks.configs['recommended-latest'],
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
      parserOptions: {
        ecmaVersion: 'latest',
        ecmaFeatures: { jsx: true },
        sourceType: 'module',
      },
    },
    rules: {
      'no-unused-vars': ['error', { varsIgnorePattern: '^[A-Z_]' }],
    },
  },
])


==================================================
FILE: ./server/package.json
==================================================
{
  "name": "server",
  "version": "1.0.0",
  "type": "module",
  "main": "index.js",
  "scripts": {
    "start": "kill-port 5000 && node index.js"
  },
  "dependencies": {
    "@google/generative-ai": "^0.7.1",
    "cors": "^2.8.5",
    "dotenv": "^16.6.1",
    "express": "^4.21.2"
  },
  "devDependencies": {
    "kill-port": "^2.0.1"
  }
}


==================================================
FILE: ./server/index.js
==================================================
import dotenv from "dotenv";
import express from "express";
import cors from "cors";
import { GoogleGenerativeAI } from "@google/generative-ai";

dotenv.config();

const app = express();
// app.use(cors());
app.use(
  cors({
    origin: "*",
    methods: ["GET", "POST"],
    allowedHeaders: ["Content-Type"],
  })
);
app.use(express.json());

const apiKey = process.env.GEMINI_API_KEY;

if (!apiKey) {
  console.error("‚ùå GEMINI_API_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ .env");
  process.exit(1);
}

const genAI = new GoogleGenerativeAI(apiKey);
const model = genAI.getGenerativeModel({ model: "gemini-2.5-flash" });

app.post("/api/translate", async (req, res) => {
  try {
    const { text, source, target } = req.body;

    if (!text) {
      return res.status(400).json({ error: "–¢–µ–∫—Å—Ç –Ω–µ —É–∫–∞–∑–∞–Ω" });
    }

    let prompt = "";

    // üáπüá∑ –¢—É—Ä–µ—Ü–∫–∏–π —è–∑—ã–∫
    if (target === "tr") {
      prompt = `
–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω—ã—Ö –º–µ–Ω—é.
–ü–µ—Ä–µ–≤–µ–¥–∏ —Ç–µ–∫—Å—Ç —Å—Ç—Ä–æ–≥–æ –Ω–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π —Ç—É—Ä–µ—Ü–∫–∏–π —è–∑—ã–∫ (–ª–∞—Ç–∏–Ω–∏—Ü–∞).
–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –∫–∞–∑–∞—Ö—Å–∫–∏–µ —Å–ª–æ–≤–∞, —Å–æ—Ö—Ä–∞–Ω—è–π —Å—Ç–∏–ª—å –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–µ–∫—Å—Ç–∞.
–°–æ—Ö—Ä–∞–Ω–∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é, –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã, —Å–∫–æ–±–∫–∏, —Å–∏–º–≤–æ–ª—ã –∏ –ø—Ä–æ–±–µ–ª—ã.
–ù–µ –¥–æ–±–∞–≤–ª—è–π –ø–æ—è—Å–Ω–µ–Ω–∏–π, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤–µ–¥–∏ —Ç–µ–∫—Å—Ç.

–¢–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:
${text}
`;
    }

    // üá∞üáø –ö–∞–∑–∞—Ö—Å–∫–∏–π —è–∑—ã–∫
    else if (target === "kk") {
      prompt = `
–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω—ã—Ö –º–µ–Ω—é.
–ü–µ—Ä–µ–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –±–ª—é–¥ –∏ –æ–ø–∏—Å–∞–Ω–∏—è –Ω–∞ –∫–∞–∑–∞—Ö—Å–∫–∏–π —è–∑—ã–∫ —Ç–∞–∫, —á—Ç–æ–±—ã –∑–≤—É—á–∞–ª–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ.
–°–æ—Ö—Ä–∞–Ω–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é, –ø—Ä–æ–±–µ–ª—ã, –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã –∏ —Å–∏–º–≤–æ–ª—ã.
–ù–µ –¥–æ–±–∞–≤–ª—è–π –ø–æ—è—Å–Ω–µ–Ω–∏–π –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª–æ–≤.
–ò—Å–ø–æ–ª—å–∑—É–π —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã, –µ—Å–ª–∏ –æ–Ω–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è:

–†—ã–±–∞:
- –õ–æ—Å–æ—Å—å ‚Üí –ê–ª–±—ã—Ä—Ç
- –°–µ–º–≥–∞ ‚Üí –ê“õ—Å–µ—Ä–∫–µ
- –°—É–¥–∞–∫ ‚Üí –ö”©–∫—Å–µ—Ä–∫–µ
- –§–æ—Ä–µ–ª—å ‚Üí –ë–∞“õ—Ç–∞“õ
- –û—Å–µ—Ç—Ä ‚Üí –ë–µ–∫—ñ—Ä–µ
- –°–∞–∑–∞–Ω ‚Üí –°–∞–∑–∞–Ω –±–∞–ª—ã“õ
- –£–≥–æ—Ä—å ‚Üí –ñ—ã–ª–∞–Ω–±–∞–ª—ã“õ

–ú–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã:
- –ö—Ä–µ–≤–µ—Ç–∫–∞ ‚Üí –ê—Å—à–∞—è–Ω
- –ú–∏–¥–∏—è ‚Üí –ú–∏–¥–∏—è
- –£—Å—Ç—Ä–∏—Ü–∞ ‚Üí –£—Å—Ç—Ä–∏—Ü–∞
- –ö—Ä–∞–± ‚Üí –¢–µ“£—ñ–∑ —à–∞—è–Ω—ã
- –†–∞–∫ ‚Üí –°—É —à–∞—è–Ω

–û–≤–æ—â–∏:
- –ë–∞–∫–ª–∞–∂–∞–Ω ‚Üí –ë–∞—è–ª–¥—ã
- –¶—É–∫–∫–∏–Ω–∏ ‚Üí –ö”ô–¥—ñ
- –®–ø–∏–Ω–∞—Ç ‚Üí –ê—Å–∂–∞–ø—ã—Ä–∞“õ
- –ü–æ–º–∏–¥–æ—Ä—ã ‚Üí “ö—ã–∑–∞–Ω–∞“õ

–ú—è—Å–æ:
- –ö–æ–Ω–∏–Ω–∞ ‚Üí –ñ—ã–ª“õ—ã –µ—Ç—ñ
- –¢–µ–ª—è—Ç–∏–Ω–∞ ‚Üí –ë“±–∑–∞—É
- –Ø–≥–Ω–µ–Ω–æ–∫ ‚Üí “ö–æ–∑—ã

–ü—Ä–æ—á–µ–µ:
- –°–≤–µ–∂–∏–π ‚Üí –ë–∞–ª“ì—ã–Ω
- –°–≤–µ–∂–µ–≤—ã–ø–µ—á–µ–Ω–Ω—ã–π ‚Üí –ñ–∞“£–∞ –ø—ñ—Å–∫–µ–Ω
- –Ø–π—Ü–æ –ø–∞—à–æ—Ç ‚Üí –ü–∞—à–æ—Ç –∂“±–º—ã—Ä—Ç“õ–∞—Å—ã
- –°—ã—Ä–Ω–∏–∫–∏ ‚Üí –°“Ø–∑–±–µ —ñ—Ä—ñ–º—à—ñ–∫—Ç–µ—Ä—ñ
- –°–ª–∏–≤–∫–∏ ‚Üí –ö—ñ–ª–µ–≥–µ–π
- –°–æ—É—Å ‚Üí –¢“±–∑–¥—ã“õ

–¢–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:
${text}
`;
    }

    // üá¨üáß –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
    else if (target === "en") {
      prompt = `
You are a professional translator. Always translate the given text into clear, natural, and fluent **English** language ‚Äî even if it looks similar to English.
Do not skip or repeat any words. Translate absolutely everything, including individual words, short phrases, and full sentences.
Keep **ALL** punctuation, capitalization, line breaks, parentheses, numbers, emojis, and symbols exactly as in the original text.
Do not simplify or interpret the meaning ‚Äî translate as accurately and literally as possible while keeping the natural flow of English.

–¢–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:
${text}
`;
    }

    // üåç –û–±—â–∏–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —è–∑—ã–∫–æ–≤
    else {
      prompt = `
–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω—ã—Ö –º–µ–Ω—é.
–ü–µ—Ä–µ–≤–µ–¥–∏ —Ç–µ–∫—Å—Ç —Å ${source || "–æ–¥–Ω–æ–≥–æ"} —è–∑—ã–∫–∞ –Ω–∞ ${target || "–¥—Ä—É–≥–æ–π"} —è–∑—ã–∫.
–°–æ—Ö—Ä–∞–Ω–∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é, –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã, —Å–∏–º–≤–æ–ª—ã, –ø—Ä–æ–±–µ–ª—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É.
–ù–µ –¥–æ–±–∞–≤–ª—è–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –ø–µ—Ä–µ–≤–æ–¥–∏ —Ç–æ—á–Ω–æ –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ.

–¢–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:
${text}
`;
    }

    const result = await model.generateContent(prompt);

    const translation =
      result?.response?.candidates?.[0]?.content?.parts?.[0]?.text?.trim() ||
      "–ü–µ—Ä–µ–≤–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω";

    res.json({ translation });
  } catch (error) {
    console.error("‚ùå –û—à–∏–±–∫–∞ Gemini API:", error.message || error);
    res.status(500).json({ error: "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ Gemini API" });
  }
});

const port = process.env.PORT || 5000;
app.listen(port, () => console.log(`‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É ${port}`));


==================================================
FILE: ./src/main.css
==================================================
/* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ */
:root {
  --bg: #ffffff;
  --card-bg: #f3f4f6;
  --text: #1f2937;
  --border: #d1d5db;

  --btn-primary: #2563eb;
  --btn-secondary: #4b5563;

  --dropdown-bg: #ffffff;
  --dropdown-border: #d1d5db;
}

/* –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ */
body.dark {
  --bg: #0f172a;
  --card-bg: #1e293b;
  --text: #ffffff;
  --border: #334155;

  --btn-primary: #2563eb;
  --btn-secondary: #334155;

  --dropdown-bg: #1e293b;
  --dropdown-border: #334155;
}

/* –û–±—â–∏–π —Å—Ç–∏–ª—å */
body {
  background: var(--bg);
  color: var(--text);
  font-family: sans-serif;
}

/* –ö–∞—Ä—Ç–æ—á–∫–∞ */
.card {
  background: var(--card-bg);
  color: var(--text);
  padding: 20px;
  border-radius: 14px;
  width: 600px;
  margin: 80px auto;
  box-shadow: 0 4px 14px rgba(0, 0, 0, 0.25);
}

/* Textarea */
.input-box {
  width: 100%;
  background: var(--card-bg);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 12px;
  font-size: 16px;
  resize: none;
}

/* –ö–Ω–æ–ø–∫–∏ */
.btn {
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  cursor: pointer;
  color: white;
}

.btn-primary {
  background: var(--btn-primary);
}

.btn-secondary {
  background: var(--btn-secondary);
}

.btn-grey {
  background: #6b7280;
}

.copy-btn.copied {
  background: #16a34a !important;
}

/* Dropdown */
.dropdown {
  position: absolute;
  top: 110%;
  left: 0;
  background: var(--dropdown-bg);
  border: 1px solid var(--dropdown-border);
  padding: 10px;
  border-radius: 8px;
  width: 180px;
  max-height: 200px;
  overflow-y: auto;
  z-index: 10;
}

.dropdown button,
.dropdown label {
  color: var(--text);
}


==================================================
FILE: ./src/main.jsx
==================================================
import { StrictMode } from "react";
import { createRoot } from "react-dom/client";
import App from "./App.jsx";
import "./main.css";

createRoot(document.getElementById("root")).render(
  <StrictMode>
    <App />
  </StrictMode>
);


==================================================
FILE: ./src/themes.js
==================================================
export const lightTheme = {
  "--bg-color": "#f4f6f9",
  "--card-bg": "#ffffff",
  "--text-color": "#111827",
  "--button-bg": "#2563eb",
  "--button-hover": "#1d4ed8",
  "--input-bg": "#ffffff",
  "--border-color": "#e5e7eb",
};

export const darkTheme = {
  "--bg-color": "#111827",
  "--card-bg": "#1f2937",
  "--text-color": "#f9fafb",
  "--button-bg": "#3b82f6",
  "--button-hover": "#2563eb",
  "--input-bg": "#1e293b",
  "--border-color": "#374151",
};


==================================================
FILE: ./src/App.jsx
==================================================
import { useEffect, useState } from "react";
import Translator from "./components/Translator";
import { lightTheme, darkTheme } from "./themes";
import "./main.css";

export default function App() {
  const [theme, setTheme] = useState("light");

  useEffect(() => {
    const selectedTheme = theme === "light" ? lightTheme : darkTheme;
    Object.entries(selectedTheme).forEach(([key, value]) =>
      document.documentElement.style.setProperty(key, value)
    );
  }, [theme]);

  return (
    <div className="app">
      <div className="card">
        <div className="header">
          {/* <h1>AI Menu Translator</h1> */}
          {/* <button
            className="button"
            onClick={() => setTheme(theme === "light" ? "dark" : "light")}>
            {theme === "light" ? "üåô –¢—ë–º–Ω–∞—è —Ç–µ–º–∞" : "‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞"}
          </button> */}
        </div>

        <p className="small">–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ –¥–ª—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –º–µ–Ω—é (–ù–∞ –≤—Å–µ —è–∑—ã–∫–∏)</p>

        <Translator />
      </div>
    </div>
  );
}


==================================================
FILE: ./src/components/Translator.jsx
==================================================
import { useState, useEffect } from "react";

export default function Translator() {
  const [text, setText] = useState("");
  const [translations, setTranslations] = useState({});
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState("");
  const [targets, setTargets] = useState(["kk"]);
  const [showDropdown, setShowDropdown] = useState(false);
  const [theme, setTheme] = useState("light");

  useEffect(() => {
    const saved = localStorage.getItem("theme") || "light";
    setTheme(saved);
    document.body.classList.toggle("dark", saved === "dark");
  }, []);

  const toggleTheme = () => {
    const next = theme === "light" ? "dark" : "light";
    setTheme(next);
    localStorage.setItem("theme", next);
    document.body.classList.toggle("dark", next === "dark");
  };

  const languages = [
    { code: "ru", name: "–†—É—Å—Å–∫–∏–π" },
    { code: "kk", name: "–ö–∞–∑–∞—Ö—Å–∫–∏–π" },
    { code: "ky", name: "–ö–∏—Ä–≥–∏–∑—Å–∫–∏–π" },
    { code: "az", name: "–ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω—Å–∫–∏–π" },
    { code: "uz", name: "–£–∑–±–µ–∫—Å–∫–∏–π" },
    { code: "uk", name: "–£–∫—Ä–∞–∏–Ω—Å–∫–∏–π" },
    { code: "hi", name: "–•–∏–Ω–¥–∏" },
    { code: "en", name: "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π" },
    { code: "tr", name: "–¢—É—Ä–µ—Ü–∫–∏–π" },
    { code: "fr", name: "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π" },
    { code: "de", name: "–ù–µ–º–µ—Ü–∫–∏–π" },
    { code: "es", name: "–ò—Å–ø–∞–Ω—Å–∫–∏–π" },
    { code: "zh", name: "–ö–∏—Ç–∞–π—Å–∫–∏–π" },
    { code: "ja", name: "–Ø–ø–æ–Ω—Å–∫–∏–π" },
  ];

  const handleTargetChange = (code) => {
    setTargets((prev) =>
      prev.includes(code) ? prev.filter((c) => c !== code) : [...prev, code]
    );
  };

  function detectLanguageImproved(text) {
    const t = text.trim().toLowerCase();
    if (/^[a-z0-9.,!?'"()\-\s]+$/i.test(t)) return "en";
    if (/[–∞-—è—ë“Ø“±“õ“ì”ô—ñ“ª“£”©]/i.test(t)) return "ru";
    if (/[√ßƒüƒ±√∂≈ü√º]/i.test(t)) return "tr";
    return "auto";
  }

  const toLatin = (s) =>
    s
      .replace(/–ê/g, "A")
      .replace(/–í/g, "B")
      .replace(/–ï/g, "E")
      .replace(/–ö/g, "K")
      .replace(/–ú/g, "M")
      .replace(/–ù/g, "N")
      .replace(/–û/g, "O")
      .replace(/–†/g, "R")
      .replace(/–°/g, "S")
      .replace(/–¢/g, "T")
      .replace(/–£/g, "U")
      .replace(/–∞/g, "a")
      .replace(/–≤/g, "v")
      .replace(/–µ/g, "e")
      .replace(/–∫/g, "k")
      .replace(/–º/g, "m")
      .replace(/–Ω/g, "n")
      .replace(/–æ/g, "o")
      .replace(/—Ä/g, "r")
      .replace(/—Å/g, "s")
      .replace(/—Ç/g, "t")
      .replace(/—É/g, "u");

  async function handleTranslate() {
    if (!text.trim()) return;

    setLoading(true);
    setError("");
    setTranslations({});

    const source = detectLanguageImproved(text);

    try {
      const result = {};
      for (const target of targets) {
        const res = await fetch("http://localhost:5000/api/translate", {
          method: "POST",
          cache: "no-store",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            text,
            source,
            target,
            forceTarget: true,
          }),
        });

        const json = await res.json();
        let output = json.translation || "(–Ω–µ—Ç –ø–µ—Ä–µ–≤–æ–¥–∞)";
        if (target === "tr") output = toLatin(output);

        result[target] = output;
      }

      setTranslations(result);
    } catch {
      setError("–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞");
    } finally {
      setLoading(false);
    }
  }

  const handleCopy = (text) => {
    navigator.clipboard.writeText(text);
    const btn = document.activeElement;
    btn.classList.add("copied");
    setTimeout(() => btn.classList.remove("copied"), 800);
  };

  return (
    <div className="card">
      <button
        onClick={toggleTheme}
        className="btn btn-secondary"
        style={{ marginBottom: 10 }}>
        {theme === "light" ? "–¢—ë–º–Ω–∞—è —Ç–µ–º–∞" : "–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞"}
      </button>

      <h2>KAMI Menu Translator</h2>

      <textarea
        rows={4}
        className="input-box"
        placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞..."
        value={text}
        onChange={(e) => setText(e.target.value)}
      />

      <div
        style={{ marginTop: 12, display: "flex", gap: 10, flexWrap: "wrap" }}>
        <span style={{ opacity: 0.7 }}>–Ø–∑—ã–∫ ‚Üí –¶–µ–ª–∏:</span>

        <div style={{ position: "relative" }}>
          <button
            className="btn btn-secondary"
            onClick={() => setShowDropdown((prev) => !prev)}>
            {targets.length > 0
              ? `–í—ã–±—Ä–∞–Ω–æ: ${targets.length}`
              : "–í—ã–±—Ä–∞—Ç—å —è–∑—ã–∫–∏"}
          </button>

          {showDropdown && (
            <div className="dropdown">
              {languages.map((l) => (
                <label key={l.code} style={{ display: "flex", gap: 6 }}>
                  <input
                    type="checkbox"
                    checked={targets.includes(l.code)}
                    onChange={() => handleTargetChange(l.code)}
                  />
                  {l.name}
                </label>
              ))}
            </div>
          )}
        </div>

        <button
          className="btn btn-primary"
          onClick={handleTranslate}
          disabled={loading}>
          {loading ? "–ü–µ—Ä–µ–≤–æ–∂—É..." : "–ü–µ—Ä–µ–≤–µ—Å—Ç–∏"}
        </button>

        <button
          className="btn btn-grey"
          onClick={() => {
            setText("");
            setTranslations({});
            setError("");
          }}>
          –û—á–∏—Å—Ç–∏—Ç—å
        </button>
      </div>

      {error && <div style={{ marginTop: 12, color: "#ef4444" }}>{error}</div>}

      {Object.keys(translations).length > 0 && (
        <div className="result-block" style={{ marginTop: 16 }}>
          <strong>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–∞:</strong>

          {Object.entries(translations).map(([lang, result]) => {
            const langName =
              languages.find((l) => l.code === lang)?.name || lang;

            return (
              <div key={lang} style={{ marginTop: 12 }}>
                <b>{langName}:</b>
                <div style={{ display: "flex", gap: 10 }}>
                  <div style={{ flex: 1 }}>{result}</div>
                  <button
                    onClick={() => handleCopy(result)}
                    className="copy-btn btn btn-primary">
                    –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                  </button>
                </div>
              </div>
            );
          })}
        </div>
      )}
    </div>
  );
}
